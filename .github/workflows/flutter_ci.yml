name: Flutter CI

on:
push:
branches: [ main, master ]
pull_request:
branches: [ main, master ]

jobs:
build:
runs-on: ubuntu-latest

steps:
  - name: Checkout
    uses: actions/checkout@v4

  - name: Set up Flutter
    uses: subosito/flutter-action@v2
    with:
      channel: stable
      cache: true

  - name: Flutter version
    run: flutter --version

  - name: Pub get
    run: flutter pub get

  - name: Analyze
    run: flutter analyze

  - name: Run tests
    run: flutter test --no-pub -r expanded

  # Optional: ensure it compiles (debug build)
  - name: Build APK (debug)
    run: flutter build apk --debug